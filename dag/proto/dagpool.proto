syntax = "proto3";

package proto;
option go_package = '../proto';

service DagPool {
  rpc Add (AddReq) returns (AddReply) {}
  rpc Get (GetReq) returns (GetReply) {}
  rpc Remove (RemoveReq) returns (RemoveReply) {}

  rpc AddUser (AddUserReq) returns (AddUserReply){}
  rpc RemoveUser (RemoveUserReq) returns (RemoveUserReply){}
  rpc QueryUser (QueryUserReq) returns (QueryUserReply){}
  rpc UpdateUser (UpdateUserReq) returns (UpdateUserReply){}

  rpc Pin(PinReq) returns(PinReply) {}
  rpc UnPin(UnPinReq) returns(UnPinReply) {}
  rpc IsPin(IsPinReq) returns(IsPinReply) {}
}
message PoolUser {
  string username = 1;
  string pass = 2;
}
message AddReq {
  bytes block = 1;
  PoolUser user = 2;
}

message AddReply {
  string cid = 1;
}
message GetReq {
  string cid = 1;
  PoolUser user = 2;
}

message GetReply {
  bytes block = 1;
}
message RemoveReq {
  string cid = 1;
  PoolUser user = 2;
}

message RemoveReply {
  string message = 1;
}
message AddUserReq {
  PoolUser user = 1;
  string Username = 3;
  string Password = 4;
  string Policy = 5;
  uint64 Capacity = 6;
}

message AddUserReply {
  string message = 1;
}
message RemoveUserReq {
  string Username = 1;
  string Password = 2;
}

message RemoveUserReply {
  string message = 1;
}
message QueryUserReq {
  string Username = 1;
  string Password = 2;
}

message QueryUserReply {
  string Username = 1;
  string Policy = 3;
  uint64 Capacity = 4;
}
message UpdateUserReq{
  PoolUser user = 1;
  string NewUsername = 3;
  string NewPassword = 4;
  string Policy = 5;
  uint64 Capacity = 6;
}

message UpdateUserReply {
  string message = 1;
}

message PinReq {
  string cid = 1;
  PoolUser user = 2;
}

message PinReply {
  string message = 1;
}

message UnPinReq {
  string cid = 1;
  PoolUser user = 2;
}

message UnPinReply {
  string message = 1;
}

message IsPinReq {
  string cid = 1;
  PoolUser user = 2;
}

message IsPinReply {
  bool is = 1;
}
